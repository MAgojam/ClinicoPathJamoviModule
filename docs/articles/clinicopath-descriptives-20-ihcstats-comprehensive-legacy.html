<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comprehensive Guide to IHC Expression Analysis with ihcstats â€¢ ClinicoPath</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comprehensive Guide to IHC Expression Analysis with ihcstats">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPath</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.32</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../dev/index.html"><span class="fa fa-cogs"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/clinicopath-descriptives-01-introduction.html">ClinicoPath Descriptives 01: Introduction to Descriptive Statistics for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-02-data-quality.html">Data Quality Assessment and Exploration</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-02-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-data-summary.html">Summarising Clinicopathological Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-03-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-04-benford.html">Vignette: Checking Data Authenticity with Benford's Law</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-04-data-quality-exploration.html">ClinicoPath Descriptives 04: Data Quality Assessment for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-05-alluvial.html">Vignette: Visualizing Data Flows with Alluvial Diagrams</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-05-digital-pathology.html">Digital Pathology Validation: AI-Assisted Quantification and Method Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-06-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-06-molecular-workflow.html">Modern Molecular Pathology Workflow: Integrated Morphologic and Molecular Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-07-ihcstats-comprehensive-guide.html">Comprehensive IHC Analysis Guide</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-08-function-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-09-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-09-function-alluvial.html">Vignette: Visualizing Data Flows with Alluvial Diagrams</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-10-function-benford.html">Vignette: Checking Data Authenticity with Benford's Law</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-11-function-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-11-swimmerplot.html">Vignette: Creating Advanced Swimmer Plots with Date and Event Handling</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-12-function-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-13-function-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-14-function-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-15-function-venn.html">Vignette: Visualizing Co-occurrence with Venn &amp; Upset Plots</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-16-data-summary-legacy.html">Summarising Clinicopathological Data</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-17-introduction-legacy.html">ClinicoPathDescriptives: Introduction to Clinical and Pathological Descriptive Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-18-digital-pathology-validation-legacy.html">Digital Pathology Validation: AI-Assisted Quantification and Method Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-19-molecular-pathology-workflow-legacy.html">Modern Molecular Pathology Workflow: Integrated Morphologic and Molecular Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-20-ihcstats-comprehensive-legacy.html">Comprehensive Guide to IHC Expression Analysis with ihcstats</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-21-use-in-r-legacy.html">Use ClinicoPathDescriptives in R</a></li>
    <li><a class="dropdown-item" href="../articles/clinicopath-descriptives-22-venn-legacy.html">Vignette: Visualizing Co-occurrence with Venn &amp; Upset Plots</a></li>
    <li><a class="dropdown-item" href="../articles/general-01-getting-started.html">Getting Started with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-02-jamovi-user-guide.html">General 01: jamovi User Guide for Statistical Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-03-clinical-examples.html">Clinical Research Examples with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-03-getting-started-alt.html">General 02: Getting Started with Statistical Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/general-04-clinical-workflow.html">Clinical Research Workflow with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-05-jamovi-workflow.html">Using jsurvival in jamovi: Complete Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/general-06-jamovi-workflow-examples.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-07-pathology-jamovi.html">Using jamovi for the Common Statistical Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/general-08-advanced-topics.html">Advanced Survival Analysis with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-09-analysis-gallery.html">Complete Analysis Gallery - All jjstatsplot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/general-10-visualization-gallery.html">Visualization Gallery for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/general-11-data-preparation.html">Data Preparation for Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-12-module-development.html">Module Development for Jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/general-13-quick-reference.html">Quick Reference Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-14-r-programming-guide.html">R Programming Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-15-troubleshooting-faq.html">Troubleshooting Guide and FAQ for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-16-use-clinicopath-in-r.html">Use ClinicoPathDescriptives in R</a></li>
    <li><a class="dropdown-item" href="../articles/general-17-users-of-clinicopath.html">Users of ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/general-18-analysis-gallery-legacy.html">Complete Analysis Gallery - All jjstatsplot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/general-19-clinical-examples-legacy.html">Clinical Research Examples with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-20-clinical-workflow-legacy.html">Clinical Research Workflow with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/general-21-visualization-gallery-legacy.html">Visualization Gallery for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/general-22-advanced-topics-legacy.html">Advanced Survival Analysis with jsurvival</a></li>
    <li><a class="dropdown-item" href="../articles/general-23-data-preparation-legacy.html">Data Preparation for Survival Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-24-jamovi-user-guide-legacy.html">Complete jamovi User Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-25-jamovi-workflow-examples-legacy.html">Jamovi Workflow Examples for Decision Tree and Markov Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/general-26-jamovi-workflow-legacy.html">Using jsurvival in jamovi: Complete Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/general-28-pathology-jamovi-legacy.html">Using jamovi for the Common Statistical Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/general-29-quick-reference-legacy.html">Quick Reference Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-30-r-programming-guide-legacy.html">R Programming Guide for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/general-31-troubleshooting-faq-legacy.html">Troubleshooting Guide and FAQ for jjstatsplot</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-01-introduction.html">jjStatsPlot 01: Statistical Visualization for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-02-categorical-plots.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-03-continuous-comparisons.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-04-continuous-comparisons-alt.html">Continuous Variable Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-05-correlations-scatterplots.html">Correlations and Scatter Plots</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-06-use-in-r.html">Use jjstatsplot in R</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-07-continuous-comparisons-legacy.html">Continuous Variable Comparisons</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-08-categorical-plots-legacy.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-09-continuous-comparisons-legacy.html">Categorical Plot Functions</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-10-correlations-scatterplots-legacy.html">Correlations and Scatter Plots</a></li>
    <li><a class="dropdown-item" href="../articles/jjstatsplot-11-introduction-legacy.html">jjstatsplot: Statistical Visualization for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-01-introduction.html">jSurvival 01: Introduction to Survival Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-02-person-time-analysis.html">Person-Time Analysis in jsurvival Module</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-03-treatment-response.html">Treatment Response Analysis in Oncology</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-04-stage-migration-analysis.html">Stage Migration Analysis: Understanding the Will Rogers Phenomenon</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-05-function-swimmerplot.html">Vignette: Creating Advanced Swimmer Plots with Date and Event Handling</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-06-function-waterfall.html">Vignette: Creating Waterfall Plots to Show Patient Response to Therapy</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-07-use-in-r.html">Use jsurvival in R</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-08-stage-migration-analysis-legacy.html">Stage Migration Analysis: Understanding the Will Rogers Phenomenon</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-09-waterfall-legacy.html">Vignette: Creating Waterfall Plots to Show Patient Response to Therapy</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-10-introduction-legacy.html">jsurvival: Introduction to Survival Analysis for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-11-person-time-analysis-legacy.html">Person-Time Analysis in jsurvival Module</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-12-treatment-response-analysis-legacy.html">Treatment Response Analysis in Oncology</a></li>
    <li><a class="dropdown-item" href="../articles/jsurvival-13-use-in-r-legacy.html">Use jsurvival in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-01-introduction.html">MedDecide 01: Introduction to Medical Decision Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-02-comprehensive-guide.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-03-agreement-analysis.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-03-roc-analysis.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-04-decision-tree-guide.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-05-decision-tree-analysis.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-06-decision-tree-vs-markov.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-07-decision-trees.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-08-decision-panel-clinical.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-09-decision-panel-advanced.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-10-decision-panel-optimization.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-11-precision-oncology.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-12-nogoldstandard.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-13-diagnostic-tests.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-14-diagnostic-style-quick-guide.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-15-diagnostic-style-clustering.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-16-use-in-r.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-17-introduction-legacy.html">meddecide: Introduction to Medical Decision Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-18-roc-analysis-legacy.html">ROC Curve Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-19-decisionpanel-advanced-legacy.html">Advanced Features and Customization in Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-20-decisionpanel-clinical-legacy.html">Clinical Applications of Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-21-decisionpanel-optimization-legacy.html">Introduction to Decision Panel Optimization</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-22-diagnostic-style-clustering-legacy.html">Diagnostic Style Clustering: Identifying Pathologist 'Schools' and Diagnostic Preferences</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-23-diagnostic-style-quick-guide-legacy.html">Quick Guide: Diagnostic Style Clustering in jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-24-agreement-analysis-legacy.html">Inter-Rater Agreement and Reliability Analysis in Pathology</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-25-diagnostic-tests-legacy.html">Diagnostic Test Evaluation</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-26-medical-decision-tree-guide-legacy.html">Medical Decision Tree - Clinical Implementation Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-27-nogoldstandard-legacy.html">Analyzing Diagnostic Tests without a Gold Standard</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-28-decision-tree-examples-legacy.html">Decision Tree and Markov Chain Analysis Examples</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-29-decision-tree-vs-markov-analysis-legacy.html">Decision Tree vs Markov Chain Analysis: Complete Guide</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-30-decisiontree-analysis-vignette-legacy.html">Decision Tree Graph Analysis: Comprehensive Guide and Testing</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-31-precision-oncology-biomarkers-legacy.html">Precision Oncology: Biomarker-Guided Treatment Selection and Outcome Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-32-vignettes-legacy.html">meddecide: Medical Decision Making in R</a></li>
    <li><a class="dropdown-item" href="../articles/meddecide-33-use-in-r-legacy.html">Use meddecide in R</a></li>
    <li><a class="dropdown-item" href="../articles/module-development-jamovi.html">Module Development for Jamovi</a></li>
    <li><a class="dropdown-item" href="../articles/pkgnet-report.html">ClinicoPath Package Report, by pkgnet</a></li>
    <li><a class="dropdown-item" href="../articles/use-jjstatsplot-in-R.html">Use jjstatsplot in R</a></li>
    <li><a class="dropdown-item" href="../articles/users-of-clinicopath.html">Users of ClinicoPath</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="http://twitter.com/serdarbalci"><span class="fa fab fa-twitter fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sbalci/ClinicoPathJamoviModule/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comprehensive Guide to IHC Expression Analysis with ihcstats</h1>
            <h3 data-toc-skip class="subtitle">Implementing Four
Research Methodologies for Immunohistochemical Data Analysis</h3>
                        <h4 data-toc-skip class="author">ClinicoPath
Development Team</h4>
            
            <h4 data-toc-skip class="date">2025-06-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/sbalci/ClinicoPathJamoviModule/blob/HEAD/vignettes/clinicopath-descriptives-20-ihcstats-comprehensive-legacy.Rmd" class="external-link"><code>vignettes/clinicopath-descriptives-20-ihcstats-comprehensive-legacy.Rmd</code></a></small>
      <div class="d-none name"><code>clinicopath-descriptives-20-ihcstats-comprehensive-legacy.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>ihcstats</code> function in the ClinicoPath jamovi module
provides comprehensive immunohistochemical (IHC) expression analysis by
implementing methodologies from four landmark research papers:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Matsuoka et al.Â (2011)</strong> - Wardâ€™s hierarchical
clustering for colorectal cancer prognosis</li>
<li>
<strong>Carvalho et al.Â (2011)</strong> - Iterative marker selection
for renal oncocytoma diagnosis<br>
</li>
<li>
<strong>Olsen et al.Â (2006)</strong> - Differential diagnosis
clustering for synovial sarcoma, MPNST, and Ewing sarcoma</li>
<li>
<strong>Sterlacci et al.Â (2019)</strong> - TIL signature analysis
for NSCLC</li>
</ol>
<p>This vignette demonstrates the theoretical framework and clinical
applications of the <code>ihcstats</code> function with comprehensive
synthetic datasets that cover all implemented methodologies.</p>
<p><strong>Note</strong>: This vignette focuses on the conceptual
understanding and clinical applications. For hands-on analysis, use the
interactive jamovi interface where the ihcstats function is fully
operational.</p>
</div>
<div class="section level2">
<h2 id="loading-required-libraries-and-data">Loading Required Libraries and Data<a class="anchor" aria-label="anchor" href="#loading-required-libraries-and-data"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.serdarbalci.com/ClinicoPathJamoviModule">ClinicoPath</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/survminer/index.html" class="external-link">survminer</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://svn.r-project.org/R-packages/trunk/cluster/" class="external-link">cluster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create synthetic sarcoma IHC data based on Olsen et al. (2006) study</span></span>
<span><span class="co"># 22 IHC markers for differential diagnosis of sarcomas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sarcoma_ihc_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  SampleID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"SARC_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%03d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">73</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  TumorType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Synovial_Sarcoma"</span>, <span class="fl">23</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MPNST"</span>, <span class="fl">23</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Ewing_Sarcoma"</span>, <span class="fl">27</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="co"># Core sarcoma markers based on Olsen study results</span></span>
<span>  PGP9.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">73</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  Fli1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: mostly negative</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: mostly negative  </span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Ewing: 63% positive</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Nestin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: rare</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: 78% positive</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.08</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ewing: rare</span></span>
<span>  <span class="op">)</span>,</span>
<span>  S100 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: 35% positive</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.12</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: 57% positive</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Ewing: variable</span></span>
<span>  <span class="op">)</span>,</span>
<span>  CD99 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: 70% positive</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: variable</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.02</span>, <span class="fl">0.93</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ewing: 93% strong</span></span>
<span>  <span class="op">)</span>,</span>
<span>  EMA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: 91% positive, 74% strong</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.08</span>, <span class="fl">0.02</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: rare</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">0.12</span>, <span class="fl">0.03</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ewing: rare</span></span>
<span>  <span class="op">)</span>,</span>
<span>  CK7 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: highly specific</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: negative</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.0</span>, <span class="fl">0.0</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Ewing: negative</span></span>
<span>  <span class="op">)</span>,</span>
<span>  Vimentin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">73</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.25</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  CD56 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.44</span>, <span class="fl">0.26</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: 70% positive, 26% strong</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: less common</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ewing: uncommon</span></span>
<span>  <span class="op">)</span>,</span>
<span>  bcl2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.13</span>, <span class="fl">0.39</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span>, <span class="co"># Synovial: 87% positive, 48% strong</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">23</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>, <span class="co"># MPNST: less common</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Negative"</span>, <span class="st">"Weak"</span>, <span class="st">"Strong"</span><span class="op">)</span>, <span class="fl">27</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.25</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ewing: uncommon</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display sample of the synthetic sarcoma data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Synthetic Sarcoma IHC Dataset (first 10 cases):\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sarcoma_ihc_data</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nsclc_til_data"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"colorectal_ihc_data"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"renal_ihc_data"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dataset-overview">Dataset Overview<a class="anchor" aria-label="anchor" href="#dataset-overview"></a>
</h2>
<p>Our comprehensive dataset includes <strong>300 patients</strong> with
<strong>60 variables</strong> covering:</p>
<ul>
<li>
<strong>8 tumor types</strong> for differential diagnosis</li>
<li>
<strong>4 NSCLC histotypes</strong> for TIL analysis</li>
<li>
<strong>34 IHC markers</strong> with different scoring scales</li>
<li>
<strong>Multi-region tumor data</strong> (central vs invasive)</li>
<li>
<strong>Survival outcomes</strong> and clinical variables</li>
<li>
<strong>TIL quantification</strong> and immune signatures</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Dataset dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dataset dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">ihc_comprehensive_data</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tumor type distribution</span></span>
<span><span class="va">tumor_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ihc_comprehensive_data</span><span class="op">$</span><span class="va">Tumor_Type</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Tumor_Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">tumor_table</span><span class="op">)</span>, Count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tumor_table</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Distribution of Tumor Types"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># IHC scoring scales represented</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nIHC Scoring Scales in Dataset:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Standard (0, 1+, 2+, 3+): Core sarcoma markers\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Matsuoka (Mild, Moderate, Marked): Colorectal markers\n"</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Carvalho (0, 1, 2): Renal markers\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Binary (Negative, Positive): Selected markers\n"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-ihc-expression-analysis">Basic IHC Expression Analysis<a class="anchor" aria-label="anchor" href="#basic-ihc-expression-analysis"></a>
</h2>
<div class="section level3">
<h3 id="example-1-sarcoma-differential-diagnosis-olsen-et-al--2006">Example 1: Sarcoma Differential Diagnosis (Olsen et al.Â 2006)<a class="anchor" aria-label="anchor" href="#example-1-sarcoma-differential-diagnosis-olsen-et-al--2006"></a>
</h3>
<p>This example replicates the landmark Olsen study that used
hierarchical cluster analysis for differential diagnosis of synovial
sarcoma, malignant peripheral nerve sheath tumor (MPNST), and Ewing
sarcoma using tissue microarray data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic hierarchical clustering with sarcoma markers from Olsen study</span></span>
<span><span class="co"># Key markers: EMA/CK7 for synovial sarcoma, S100/nestin for MPNST, CD99/Fli-1 for Ewing sarcoma</span></span>
<span><span class="va">basic_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EMA"</span>, <span class="st">"CK7"</span>, <span class="st">"S100"</span>, <span class="st">"Nestin"</span>, <span class="st">"CD99"</span>, <span class="st">"Fli1"</span>, <span class="st">"CD56"</span>, <span class="st">"bcl2"</span>, <span class="st">"Vimentin"</span><span class="op">)</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  distanceMetric <span class="op">=</span> <span class="st">"gower"</span>, </span>
<span>  linkageMethod <span class="op">=</span> <span class="st">"average"</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">5</span>,  <span class="co"># Olsen study identified 5 main clusters (Groups A-E)</span></span>
<span>  showDendrogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showHeatmap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  computeHScore <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Simplified to avoid technical issues</span></span>
<span>  significanceThreshold <span class="op">=</span> <span class="fl">0.01</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"IHC clustering analysis complete. See jamovi interface for interactive analysis."</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show the synthetic sarcoma data structure for reference</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Olsen Study Sarcoma Markers Dataset Structure:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Olsen Study Sarcoma Markers Dataset Structure:</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Sample Size: 73 cases (23 Synovial Sarcoma, 23 MPNST, 27 Ewing Sarcoma)\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## - Sample Size: 73 cases (23 Synovial Sarcoma, 23 MPNST, 27 Ewing Sarcoma)</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Key Diagnostic Markers:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## - Key Diagnostic Markers:</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  * Synovial Sarcoma: EMA+/CK7+ (100% specific)\n"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##   * Synovial Sarcoma: EMA+/CK7+ (100% specific)</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  * MPNST: S100+/Nestin+ (100% specific, 48% sensitive)\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   * MPNST: S100+/Nestin+ (100% specific, 48% sensitive)</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  * Ewing Sarcoma: CD99 membranous+/Fli-1+ (96% specific, 56% sensitive)\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   * Ewing Sarcoma: CD99 membranous+/Fli-1+ (96% specific, 56% sensitive)</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Additional markers: CD56, bcl-2, Vimentin for differential clustering\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## - Additional markers: CD56, bcl-2, Vimentin for differential clustering</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFor interactive analysis, use the ihcstats function in jamovi interface.\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## For interactive analysis, use the ihcstats function in jamovi interface.</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="clinical-applications-summary">Clinical Applications Summary<a class="anchor" aria-label="anchor" href="#clinical-applications-summary"></a>
</h2>
<p>The <code>ihcstats</code> function provides four major clinical
methodologies:</p>
<div class="section level3">
<h3 id="olsen-et-al--2006---sarcoma-differential-diagnosis">1. <strong>Olsen et al.Â (2006) - Sarcoma Differential
Diagnosis</strong><a class="anchor" aria-label="anchor" href="#olsen-et-al--2006---sarcoma-differential-diagnosis"></a>
</h3>
<ul>
<li>
<strong>Purpose</strong>: Distinguish synovial sarcoma, MPNST, and
Ewing sarcoma</li>
<li>
<strong>Method</strong>: Hierarchical clustering of 22 IHC
markers</li>
<li>
<strong>Key Finding</strong>: EMA/CK7 for synovial sarcoma (100%
specific)</li>
<li>
<strong>Clinical Impact</strong>: Improved accuracy in small core
biopsies</li>
</ul>
</div>
<div class="section level3">
<h3 id="matsuoka-et-al--2011---prognostic-clustering">2. <strong>Matsuoka et al.Â (2011) - Prognostic
Clustering</strong><a class="anchor" aria-label="anchor" href="#matsuoka-et-al--2011---prognostic-clustering"></a>
</h3>
<ul>
<li>
<strong>Purpose</strong>: Colorectal cancer prognosis
prediction</li>
<li>
<strong>Method</strong>: Wardâ€™s clustering with survival
analysis</li>
<li>
<strong>Key Markers</strong>: p53, Ki67, VEGF, COX-2</li>
<li>
<strong>Clinical Impact</strong>: Patient stratification for
treatment planning</li>
</ul>
</div>
<div class="section level3">
<h3 id="carvalho-et-al--2011---marker-optimization">3. <strong>Carvalho et al.Â (2011) - Marker
Optimization</strong><a class="anchor" aria-label="anchor" href="#carvalho-et-al--2011---marker-optimization"></a>
</h3>
<ul>
<li>
<strong>Purpose</strong>: Renal oncocytoma vs chromophobe RCC
diagnosis</li>
<li>
<strong>Method</strong>: Iterative marker selection with PCA</li>
<li>
<strong>Key Markers</strong>: CD117, Vimentin, E-Cadherin, CK7</li>
<li>
<strong>Clinical Impact</strong>: Minimal marker panel for accurate
diagnosis</li>
</ul>
</div>
<div class="section level3">
<h3 id="sterlacci-et-al--2019---immune-microenvironment">4. <strong>Sterlacci et al.Â (2019) - Immune
Microenvironment</strong><a class="anchor" aria-label="anchor" href="#sterlacci-et-al--2019---immune-microenvironment"></a>
</h3>
<ul>
<li>
<strong>Purpose</strong>: NSCLC immune signature analysis<br>
</li>
<li>
<strong>Method</strong>: TIL clustering with immune markers</li>
<li>
<strong>Key Markers</strong>: CD3, CD8, CD20, PD-L1</li>
<li>
<strong>Clinical Impact</strong>: Immunotherapy response
prediction</li>
</ul>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"=== INTERACTIVE USAGE IN JAMOVI ===\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## === INTERACTIVE USAGE IN JAMOVI ===</span></span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"1. Load your IHC dataset with marker columns\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 1. Load your IHC dataset with marker columns</span></span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"2. Navigate to: Exploration â†’ ClinicoPath â†’ IHC Statistics\n"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## 2. Navigate to: Exploration â†’ ClinicoPath â†’ IHC Statistics</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"3. Select appropriate markers for your diagnostic question\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 3. Select appropriate markers for your diagnostic question</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"4. Choose methodology based on clinical context:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 4. Choose methodology based on clinical context:</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   - Diagnostic clustering: Use Olsen method\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    - Diagnostic clustering: Use Olsen method</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   - Prognostic analysis: Use Matsuoka method\n"</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">##    - Prognostic analysis: Use Matsuoka method</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   - Marker optimization: Use Carvalho method\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    - Marker optimization: Use Carvalho method</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"   - Immune profiling: Use Sterlacci method\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    - Immune profiling: Use Sterlacci method</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"5. Interpret results with statistical guidance provided\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 5. Interpret results with statistical guidance provided</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="example-2-different-distance-metrics-and-clustering-methods">Example 2: Different Distance Metrics and Clustering Methods<a class="anchor" aria-label="anchor" href="#example-2-different-distance-metrics-and-clustering-methods"></a>
</h3>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different clustering approaches</span></span>
<span><span class="va">methods_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Hierarchical + Gower"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span><span class="op">)</span>,</span>
<span>    clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>    distanceMetric <span class="op">=</span> <span class="st">"gower"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"Hierarchical + Jaccard"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span><span class="op">)</span>,</span>
<span>    clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>, </span>
<span>    distanceMetric <span class="op">=</span> <span class="st">"jaccard"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"PAM Clustering"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span><span class="op">)</span>,</span>
<span>    clusterMethod <span class="op">=</span> <span class="st">"pam"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"K-means"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span><span class="op">)</span>,</span>
<span>    clusterMethod <span class="op">=</span> <span class="st">"kmeans"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare cluster sizes</span></span>
<span><span class="va">cluster_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">methods_comparison</span><span class="op">)</span>,</span>
<span>  Cluster_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">methods_comparison</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">clusterSummary</span><span class="op">$</span><span class="va">asDF</span><span class="op">$</span><span class="va">size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Cluster_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">methods_comparison</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">clusterSummary</span><span class="op">$</span><span class="va">asDF</span><span class="op">$</span><span class="va">size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  Cluster_3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">methods_comparison</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">clusterSummary</span><span class="op">$</span><span class="va">asDF</span><span class="op">$</span><span class="va">size</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">cluster_comparison</span>, caption <span class="op">=</span> <span class="st">"Comparison of Clustering Methods"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="matsuoka-2011-methodology-prognostic-clustering">Matsuoka 2011 Methodology: Prognostic Clustering<a class="anchor" aria-label="anchor" href="#matsuoka-2011-methodology-prognostic-clustering"></a>
</h2>
<div class="section level3">
<h3 id="wards-hierarchical-clustering-with-survival-analysis">Wardâ€™s Hierarchical Clustering with Survival Analysis<a class="anchor" aria-label="anchor" href="#wards-hierarchical-clustering-with-survival-analysis"></a>
</h3>
<p>The Matsuoka approach uses Wardâ€™s method for prognostic clustering
with survival outcomes.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Matsuoka-style prognostic clustering</span></span>
<span><span class="va">matsuoka_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">colorectal_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p53"</span>, <span class="st">"Ki67"</span>, <span class="st">"VEGF"</span>, <span class="st">"COX2"</span><span class="op">)</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  linkageMethod <span class="op">=</span> <span class="st">"ward.D2"</span>,  <span class="co"># Ward's method</span></span>
<span>  scoringScale <span class="op">=</span> <span class="st">"matsuoka"</span>,  <span class="co"># 3-tier system</span></span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  prognosticClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  survivalTimeVar <span class="op">=</span> <span class="st">"Overall_Survival_Months"</span>,</span>
<span>  survivalEventVar <span class="op">=</span> <span class="st">"Death_Event"</span>,</span>
<span>  showDendrogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showHeatmap <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display prognostic clustering results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">matsuoka_result</span><span class="op">$</span><span class="va">prognosticTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Matsuoka Prognostic Clustering Results"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display survival analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">matsuoka_result</span><span class="op">$</span><span class="va">survivalTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Cox Regression Analysis for Prognostic Groups"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multi-region-tumor-analysis">Multi-Region Tumor Analysis<a class="anchor" aria-label="anchor" href="#multi-region-tumor-analysis"></a>
</h3>
<p>The Matsuoka methodology includes analysis of central vs invasive
tumor regions.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-region analysis (central vs invasive)</span></span>
<span><span class="va">regional_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">colorectal_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p53"</span>, <span class="st">"Ki67"</span>, <span class="st">"VEGF"</span>, <span class="st">"COX2"</span><span class="op">)</span>,</span>
<span>  tumorRegionAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  centralRegionVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p53_Central"</span>, <span class="st">"Ki67_Central"</span>, <span class="st">"VEGF_Central"</span>, <span class="st">"COX2_Central"</span><span class="op">)</span>,</span>
<span>  invasiveRegionVar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p53_Invasive"</span>, <span class="st">"Ki67_Invasive"</span>, <span class="st">"VEGF_Invasive"</span>, <span class="st">"COX2_Invasive"</span><span class="op">)</span>,</span>
<span>  scoringScale <span class="op">=</span> <span class="st">"matsuoka"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display regional analysis results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">regional_result</span><span class="op">$</span><span class="va">regionalTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Multi-Region Analysis: Central vs Invasive Front"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="carvalho-2011-methodology-iterative-marker-selection">Carvalho 2011 Methodology: Iterative Marker Selection<a class="anchor" aria-label="anchor" href="#carvalho-2011-methodology-iterative-marker-selection"></a>
</h2>
<div class="section level3">
<h3 id="optimal-marker-panel-identification">Optimal Marker Panel Identification<a class="anchor" aria-label="anchor" href="#optimal-marker-panel-identification"></a>
</h3>
<p>The Carvalho approach uses iterative selection to identify optimal
marker combinations.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Carvalho-style iterative marker selection</span></span>
<span><span class="va">carvalho_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">renal_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD117"</span>, <span class="st">"Vimentin_Carvalho"</span>, <span class="st">"E_Cadherin"</span>, <span class="st">"CK7"</span><span class="op">)</span>,</span>
<span>  scoringScale <span class="op">=</span> <span class="st">"carvalho"</span>,  <span class="co"># 0-2 scale</span></span>
<span>  iterativeClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  distanceMetric <span class="op">=</span> <span class="st">"gower"</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  showClusterValidation <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display optimal markers</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">carvalho_result</span><span class="op">$</span><span class="va">optimalMarkersTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Carvalho Optimal Marker Selection Results"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pca-analysis-with-k-means">PCA Analysis with K-means<a class="anchor" aria-label="anchor" href="#pca-analysis-with-k-means"></a>
</h3>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># PCA + K-means approach (alternative Carvalho method)</span></span>
<span><span class="va">carvalho_pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">renal_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD117"</span>, <span class="st">"Vimentin_Carvalho"</span>, <span class="st">"E_Cadherin"</span>, <span class="st">"CK7"</span><span class="op">)</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"pca_kmeans"</span>,</span>
<span>  pcaAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showPCAPlot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  standardizeData <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display PCA results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">carvalho_pca</span><span class="op">$</span><span class="va">pcaTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Principal Component Analysis Results"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="olsen-2006-methodology-differential-diagnosis">Olsen 2006 Methodology: Differential Diagnosis<a class="anchor" aria-label="anchor" href="#olsen-2006-methodology-differential-diagnosis"></a>
</h2>
<div class="section level3">
<h3 id="sarcoma-differential-diagnosis-clustering">Sarcoma Differential Diagnosis Clustering<a class="anchor" aria-label="anchor" href="#sarcoma-differential-diagnosis-clustering"></a>
</h3>
<p>The Olsen approach focuses on differential diagnosis using antibody
panels.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Olsen-style differential diagnosis</span></span>
<span><span class="va">olsen_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span>, <span class="st">"CD34"</span>, <span class="st">"Cytokeratin"</span>, <span class="st">"MDM2"</span>, <span class="st">"CDK4"</span><span class="op">)</span>,</span>
<span>  differentialDiagnosis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tumorTypeVar <span class="op">=</span> <span class="st">"Tumor_Type"</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  linkageMethod <span class="op">=</span> <span class="st">"complete"</span>,  <span class="co"># Complete linkage as in Olsen</span></span>
<span>  clusterCutHeight <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  calculateDiagnosticMetrics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  antibodyOptimization <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  olsenVisualization <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display differential diagnosis results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">olsen_result</span><span class="op">$</span><span class="va">differentialTable</span><span class="op">$</span><span class="va">asDF</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Olsen Differential Diagnosis Results (First 10 Cases)"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="antibody-performance-analysis">Antibody Performance Analysis<a class="anchor" aria-label="anchor" href="#antibody-performance-analysis"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display antibody performance metrics</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">olsen_result</span><span class="op">$</span><span class="va">antibodyPerformanceTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Individual Antibody Diagnostic Performance"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display optimal panels</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">olsen_result</span><span class="op">$</span><span class="va">optimalPanelTable</span><span class="op">$</span><span class="va">asDF</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Optimal Antibody Panel Combinations"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="sterlacci-2019-methodology-til-signature-analysis">Sterlacci 2019 Methodology: TIL Signature Analysis<a class="anchor" aria-label="anchor" href="#sterlacci-2019-methodology-til-signature-analysis"></a>
</h2>
<div class="section level3">
<h3 id="comprehensive-til-analysis">Comprehensive TIL Analysis<a class="anchor" aria-label="anchor" href="#comprehensive-til-analysis"></a>
</h3>
<p>The Sterlacci approach focuses on tumor-infiltrating lymphocyte
analysis with immune signatures.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sterlacci TIL signature analysis</span></span>
<span><span class="va">sterlacci_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">nsclc_til_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"CD20"</span>, <span class="st">"Granzyme_B"</span>, <span class="st">"PD1"</span>, <span class="st">"PDL1"</span>, <span class="st">"FOXP3"</span><span class="op">)</span>,</span>
<span>  sterlacciAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  immuneSignatureFocus <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  tilAnalysisMode <span class="op">=</span> <span class="st">"combined_til"</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  linkageMethod <span class="op">=</span> <span class="st">"complete"</span>,  <span class="co"># As in Sterlacci paper</span></span>
<span>  distanceMetric <span class="op">=</span> <span class="st">"gower"</span>,    <span class="co"># Gower distance for TIL data</span></span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  multipleTesting <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>  significanceThreshold <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display Sterlacci TIL results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">sterlacci_result</span><span class="op">$</span><span class="va">sterlacciTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Sterlacci TIL Signature Analysis Results"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display TIL signature characterization</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">sterlacci_result</span><span class="op">$</span><span class="va">tilSignatureTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"TIL Signature Characterization by Cluster"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="supervised-clustering-by-histotype">Supervised Clustering by Histotype<a class="anchor" aria-label="anchor" href="#supervised-clustering-by-histotype"></a>
</h3>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Supervised clustering within histotypes</span></span>
<span><span class="va">supervised_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">nsclc_til_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD3"</span>, <span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"Granzyme_B"</span>, <span class="st">"PD1"</span>, <span class="st">"PDL1"</span><span class="op">)</span>,</span>
<span>  supervisedClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groupVariable <span class="op">=</span> <span class="st">"Histotype"</span>,</span>
<span>  sterlacciAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">2</span>  <span class="co"># Within each histotype</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display supervised clustering results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">supervised_result</span><span class="op">$</span><span class="va">supervisedResultsTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Supervised Clustering Results by Histotype"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="reproducibility-testing">Reproducibility Testing<a class="anchor" aria-label="anchor" href="#reproducibility-testing"></a>
</h3>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reproducibility analysis with Cohen's kappa</span></span>
<span><span class="va">reproducibility_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">nsclc_til_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CD4"</span>, <span class="st">"CD8"</span>, <span class="st">"Granzyme_B"</span>, <span class="st">"PD1"</span><span class="op">)</span>,</span>
<span>  reproductibilityTesting <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sterlacciAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display reproducibility results</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">reproducibility_result</span><span class="op">$</span><span class="va">reproductibilityTable</span><span class="op">$</span><span class="va">asDF</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Cluster Reproducibility Analysis (Cohen's Îº)"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-visualization-options">Advanced Visualization Options<a class="anchor" aria-label="anchor" href="#advanced-visualization-options"></a>
</h2>
<div class="section level3">
<h3 id="comprehensive-visualization-analysis">Comprehensive Visualization Analysis<a class="anchor" aria-label="anchor" href="#comprehensive-visualization-analysis"></a>
</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Full visualization suite</span></span>
<span><span class="va">viz_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span>, <span class="st">"CD34"</span>, <span class="st">"MDM2"</span><span class="op">)</span>,</span>
<span>  showDendrogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showHeatmap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showPCAPlot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showScoreDist <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showClusterValidation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcaAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  standardizeData <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Visualization analysis completed with all plot types enabled."</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="diagnostic-performance-analysis">Diagnostic Performance Analysis<a class="anchor" aria-label="anchor" href="#diagnostic-performance-analysis"></a>
</h2>
<div class="section level3">
<h3 id="comprehensive-diagnostic-metrics">Comprehensive Diagnostic Metrics<a class="anchor" aria-label="anchor" href="#comprehensive-diagnostic-metrics"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Diagnostic performance with grouping variable</span></span>
<span><span class="va">diagnostic_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span>, <span class="st">"CD34"</span><span class="op">)</span>,</span>
<span>  showDiagnostics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  groupVariable <span class="op">=</span> <span class="st">"Tumor_Type"</span>,</span>
<span>  calculateDiagnosticMetrics <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display diagnostic performance</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diagnostic_result</span><span class="op">$</span><span class="va">diagnosticTable</span><span class="op">$</span><span class="va">asDF</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>      caption <span class="op">=</span> <span class="st">"Diagnostic Performance Analysis"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multiple-scoring-scales-comparison">Multiple Scoring Scales Comparison<a class="anchor" aria-label="anchor" href="#multiple-scoring-scales-comparison"></a>
</h2>
<div class="section level3">
<h3 id="comparing-different-ihc-scoring-systems">Comparing Different IHC Scoring Systems<a class="anchor" aria-label="anchor" href="#comparing-different-ihc-scoring-systems"></a>
</h3>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different scoring scales</span></span>
<span><span class="va">scoring_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Binary"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">sarcoma_ihc_data</span>, </span>
<span>                    Vimentin_Binary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">Vimentin</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2+"</span>, <span class="st">"3+"</span><span class="op">)</span>, <span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    markers <span class="op">=</span> <span class="st">"Vimentin_Binary"</span>,</span>
<span>    scoringScale <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"Standard"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="st">"Vimentin"</span>,</span>
<span>    scoringScale <span class="op">=</span> <span class="st">"standard"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"Matsuoka"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">colorectal_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="st">"p53"</span>,</span>
<span>    scoringScale <span class="op">=</span> <span class="st">"matsuoka"</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="st">"Carvalho"</span> <span class="op">=</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">renal_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="st">"CD117"</span>,</span>
<span>    scoringScale <span class="op">=</span> <span class="st">"carvalho"</span>, </span>
<span>    nClusters <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Scoring scale comparison completed for Binary, Standard, Matsuoka, and Carvalho systems."</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="optimal-k-selection-methods">Optimal K Selection Methods<a class="anchor" aria-label="anchor" href="#optimal-k-selection-methods"></a>
</h2>
<div class="section level3">
<h3 id="comparing-cluster-number-selection-approaches">Comparing Cluster Number Selection Approaches<a class="anchor" aria-label="anchor" href="#comparing-cluster-number-selection-approaches"></a>
</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different optimal K methods</span></span>
<span><span class="va">k_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elbow"</span>, <span class="st">"silhouette"</span>, <span class="st">"gap"</span><span class="op">)</span></span>
<span><span class="va">k_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">method</span> <span class="kw">in</span> <span class="va">k_methods</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">k_results</span><span class="op">[[</span><span class="va">method</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sarcoma_ihc_data</span>,</span>
<span>    markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"Desmin"</span>, <span class="st">"S100"</span><span class="op">)</span>,</span>
<span>    optimalKMethod <span class="op">=</span> <span class="va">method</span>,</span>
<span>    showClusterValidation <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    nClusters <span class="op">=</span> <span class="fl">4</span>  <span class="co"># Will be optimized</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Optimal K selection analysis completed using elbow, silhouette, and gap statistic methods."</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="clinical-integration-examples">Clinical Integration Examples<a class="anchor" aria-label="anchor" href="#clinical-integration-examples"></a>
</h2>
<div class="section level3">
<h3 id="complete-clinical-workflow">Complete Clinical Workflow<a class="anchor" aria-label="anchor" href="#complete-clinical-workflow"></a>
</h3>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Complete clinical analysis workflow</span></span>
<span><span class="va">clinical_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ihc_comprehensive_data</span>,</span>
<span>  markers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vimentin"</span>, <span class="st">"SMA"</span>, <span class="st">"CD34"</span>, <span class="st">"S100"</span>, <span class="st">"CD3"</span>, <span class="st">"CD8"</span>, <span class="st">"Ki67"</span>, <span class="st">"p53"</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Basic clustering</span></span>
<span>  clusterMethod <span class="op">=</span> <span class="st">"hierarchical"</span>,</span>
<span>  linkageMethod <span class="op">=</span> <span class="st">"ward.D2"</span>,</span>
<span>  distanceMetric <span class="op">=</span> <span class="st">"gower"</span>,</span>
<span>  nClusters <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  </span>
<span>  <span class="co"># Multiple analysis types</span></span>
<span>  prognosticClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  differentialDiagnosis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  sterlacciAnalysis <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  </span>
<span>  <span class="co"># Variables for analysis</span></span>
<span>  survivalTimeVar <span class="op">=</span> <span class="st">"Overall_Survival_Months"</span>,</span>
<span>  survivalEventVar <span class="op">=</span> <span class="st">"Death_Event"</span>,</span>
<span>  tumorTypeVar <span class="op">=</span> <span class="st">"Tumor_Type"</span>,</span>
<span>  groupVariable <span class="op">=</span> <span class="st">"Risk_Category"</span>,</span>
<span>  </span>
<span>  <span class="co"># Advanced options</span></span>
<span>  iterativeClustering <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  antibodyOptimization <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  reproductibilityTesting <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  </span>
<span>  <span class="co"># Visualization</span></span>
<span>  showDendrogram <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showHeatmap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  showPCAPlot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  computeHScore <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  </span>
<span>  <span class="co"># Statistical options</span></span>
<span>  multipleTesting <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>  significanceThreshold <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary of clinical workflow results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Clinical workflow analysis completed with:\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Cluster analysis:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">clinical_result</span><span class="op">$</span><span class="va">clusterSummary</span><span class="op">$</span><span class="va">asDF</span><span class="op">)</span>, <span class="st">"clusters identified\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- H-score analysis:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">clinical_result</span><span class="op">$</span><span class="va">hscoreTable</span><span class="op">$</span><span class="va">asDF</span><span class="op">)</span>, <span class="st">"markers analyzed\n"</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">clinical_result</span><span class="op">$</span><span class="va">prognosticTable</span><span class="op">$</span><span class="va">asDF</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- Prognostic analysis: Completed\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">clinical_result</span><span class="op">$</span><span class="va">sterlacciTable</span><span class="op">$</span><span class="va">asDF</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"- TIL signature analysis: Completed\n"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-recommendations">Summary and Recommendations<a class="anchor" aria-label="anchor" href="#summary-and-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="key-features-summary">Key Features Summary<a class="anchor" aria-label="anchor" href="#key-features-summary"></a>
</h3>
<p>The <code>ihcstats</code> function provides comprehensive IHC
analysis with the following key capabilities:</p>
<div class="section level4">
<h4 id="multiple-research-methodologies">1. <strong>Multiple Research Methodologies</strong><a class="anchor" aria-label="anchor" href="#multiple-research-methodologies"></a>
</h4>
<ul>
<li>
<strong>Matsuoka 2011</strong>: Wardâ€™s clustering + survival
analysis</li>
<li>
<strong>Carvalho 2011</strong>: Iterative marker selection</li>
<li>
<strong>Olsen 2006</strong>: Differential diagnosis clustering<br>
</li>
<li>
<strong>Sterlacci 2019</strong>: TIL signature analysis</li>
</ul>
</div>
<div class="section level4">
<h4 id="flexible-scoring-systems">2. <strong>Flexible Scoring Systems</strong><a class="anchor" aria-label="anchor" href="#flexible-scoring-systems"></a>
</h4>
<ul>
<li>Binary (Negative/Positive)</li>
<li>Standard IHC (0, 1+, 2+, 3+)</li>
<li>Carvalho scale (0, 1, 2)</li>
<li>Matsuoka 3-tier (Mild/Moderate/Marked)</li>
<li>H-score calculation (0-300)</li>
</ul>
</div>
<div class="section level4">
<h4 id="advanced-clustering-options">3. <strong>Advanced Clustering Options</strong><a class="anchor" aria-label="anchor" href="#advanced-clustering-options"></a>
</h4>
<ul>
<li>Hierarchical clustering (multiple linkage methods)</li>
<li>PAM (Partitioning Around Medoids)</li>
<li>K-means clustering</li>
<li>PCA + K-means combination</li>
</ul>
</div>
<div class="section level4">
<h4 id="distance-metrics">4. <strong>Distance Metrics</strong><a class="anchor" aria-label="anchor" href="#distance-metrics"></a>
</h4>
<ul>
<li>Gower distance (mixed data types)</li>
<li>Jaccard distance (categorical data)</li>
</ul>
</div>
<div class="section level4">
<h4 id="specialized-analyses">5. <strong>Specialized Analyses</strong><a class="anchor" aria-label="anchor" href="#specialized-analyses"></a>
</h4>
<ul>
<li>Multi-region tumor analysis</li>
<li>Survival analysis integration</li>
<li>Diagnostic performance metrics</li>
<li>Reproducibility testing</li>
<li>Antibody panel optimization</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="clinical-applications">Clinical Applications<a class="anchor" aria-label="anchor" href="#clinical-applications"></a>
</h3>
<div class="section level4">
<h4 id="pathology-practice-integration">
<strong>Pathology Practice Integration</strong><a class="anchor" aria-label="anchor" href="#pathology-practice-integration"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Sarcoma Diagnosis</strong> (Olsen methodology)
<ul>
<li>Use comprehensive antibody panels</li>
<li>Optimize marker combinations</li>
<li>Calculate diagnostic performance</li>
</ul>
</li>
<li>
<strong>Lung Cancer TIL Analysis</strong> (Sterlacci methodology)
<ul>
<li>Quantify immune infiltration</li>
<li>Characterize TIL signatures</li>
<li>Predict immunotherapy response</li>
</ul>
</li>
<li>
<strong>Colorectal Cancer Prognosis</strong> (Matsuoka methodology)
<ul>
<li>Identify prognostic clusters</li>
<li>Perform survival analysis</li>
<li>Analyze tumor heterogeneity</li>
</ul>
</li>
<li>
<strong>Renal Tumor Diagnosis</strong> (Carvalho methodology)
<ul>
<li>Iterative marker selection</li>
<li>Optimize diagnostic panels</li>
<li>Validate marker performance</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section level3">
<h3 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h3>
<div class="section level4">
<h4 id="data-preparation">
<strong>Data Preparation</strong><a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h4>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Ensure factors are properly coded</span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">marker</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">marker</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check for missing values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify survival data format</span></span>
<span><span class="co"># Time: numeric (months/years)</span></span>
<span><span class="co"># Event: 0/1 or FALSE/TRUE</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="analysis-workflow">
<strong>Analysis Workflow</strong><a class="anchor" aria-label="anchor" href="#analysis-workflow"></a>
</h4>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Start with basic clustering</span></span>
<span><span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">markers</span>, nClusters <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Add methodology-specific options</span></span>
<span><span class="va">result2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">markers</span>, prognosticClustering <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   survivalTimeVar <span class="op">=</span> <span class="st">"time"</span>, survivalEventVar <span class="op">=</span> <span class="st">"event"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Include visualizations</span></span>
<span><span class="va">result3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ihcstats.html">ihcstats</a></span><span class="op">(</span><span class="va">data</span>, <span class="va">markers</span>, showDendrogram <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                   showHeatmap <span class="op">=</span> <span class="cn">TRUE</span>, showPCAPlot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="result-interpretation">
<strong>Result Interpretation</strong><a class="anchor" aria-label="anchor" href="#result-interpretation"></a>
</h4>
<ul>
<li>
<strong>Cluster sizes</strong>: Should be reasonably balanced</li>
<li>
<strong>Silhouette values</strong>: &gt;0.5 indicates good
clustering</li>
<li>
<strong>Survival p-values</strong>: &lt;0.05 for significant
prognostic value</li>
<li>
<strong>Cohenâ€™s Îº</strong>: &gt;0.6 indicates good
reproducibility</li>
</ul>
</div>
</div>
<div class="section level3">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h3>
<div class="section level4">
<h4 id="common-issues">
<strong>Common Issues</strong><a class="anchor" aria-label="anchor" href="#common-issues"></a>
</h4>
<ol style="list-style-type: decimal">
<li>
<strong>Small cluster sizes</strong>: Reduce number of clusters</li>
<li>
<strong>Poor clustering quality</strong>: Try different distance
metrics</li>
<li>
<strong>Missing survival data</strong>: Exclude survival analysis
options</li>
<li>
<strong>Factor level mismatches</strong>: Ensure consistent
coding</li>
</ol>
</div>
<div class="section level4">
<h4 id="performance-optimization">
<strong>Performance Optimization</strong><a class="anchor" aria-label="anchor" href="#performance-optimization"></a>
</h4>
<ul>
<li>Use focused marker panels (5-10 markers)</li>
<li>Consider data size limitations</li>
<li>Pre-filter relevant cases</li>
</ul>
<p>This comprehensive guide demonstrates the full capabilities of the
<code>ihcstats</code> function for modern pathology practice and
research applications.</p>
<hr>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>The <code>ihcstats</code> function implements methodologies from the
following key research papers:</p>
<div class="section level3">
<h3 id="primary-ihc-clustering-methods">Primary IHC Clustering Methods<a class="anchor" aria-label="anchor" href="#primary-ihc-clustering-methods"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Matsuoka T, Mitomi H, Fukui N, Kanazawa H, Saito T,
Hayashi T, Yao T.</strong> (2011). Cluster analysis of claudin-1 and -4,
E-cadherin, and Î²-catenin expression in colorectal cancers. <em>Journal
of Surgical Oncology</em>, 103(7), 674-686. doi: 10.1002/jso.21854.
PMID: 21360533.</p></li>
<li><p><strong>Carvalho JC, Wasco MJ, Kunju LP, Thomas DG, Shah
RB.</strong> (2011). Cluster analysis of immunohistochemical profiles
delineates CK7, vimentin, S100A1 and C-kit (CD117) as an optimal panel
in the differential diagnosis of renal oncocytoma from its mimics.
<em>Histopathology</em>, 58(2), 169-179. doi:
10.1111/j.1365-2559.2011.03753.x. PMID: 21323945.</p></li>
<li><p><strong>Olsen SH, Thomas DG, Lucas DR.</strong> (2006). Cluster
analysis of immunohistochemical profiles in synovial sarcoma, malignant
peripheral nerve sheath tumor, and Ewing sarcoma. <em>Modern
Pathology</em>, 19(5), 659-668. doi: 10.1038/modpathol.3800569. PMID:
16528378.</p></li>
<li><p><strong>Sterlacci W, Fiegl M, Juskevicius D, Tzankov A.</strong>
(2020). Cluster Analysis According to Immunohistochemistry is a Robust
Tool for Non-Small Cell Lung Cancer and Reveals a Distinct, Immune
Signature-defined Subgroup. <em>Applied Immunohistochemistry &amp;
Molecular Morphology</em>, 28(4), 274-283. doi:
10.1097/PAI.0000000000000751. PMID: 31058655.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="related-high-risk-classification-methods">Related High-Risk Classification Methods<a class="anchor" aria-label="anchor" href="#related-high-risk-classification-methods"></a>
</h3>
<ol start="5" style="list-style-type: decimal">
<li>
<strong>Laas E, Ballester M, Cortez A, Graesslin O, DaraÃ¯
E.</strong> (2019). Unsupervised Clustering of Immunohistochemical
Markers to Define High-Risk Endometrial Cancer. <em>Pathology &amp;
Oncology Research</em>, 25(2), 461-469. doi: 10.1007/s12253-017-0335-y.
PMID: 29264761.</li>
</ol>
</div>
<div class="section level3">
<h3 id="diagnostic-style-analysis">Diagnostic Style Analysis<a class="anchor" aria-label="anchor" href="#diagnostic-style-analysis"></a>
</h3>
<ol start="6" style="list-style-type: decimal">
<li>
<strong>Usubutun A, Mutter GL, Saglam A, Dolgun A, Ozkan EA, Ince T,
Akyol A, Bulbul HD, Calay Z, Eren F, Gumurdulu D, Haberal AN, Ilvan S,
Karaveli S, Koyuncuoglu M, Muezzinoglu B, Muftuoglu KH, Ozdemir N, Ozen
O, Baykara S, Pestereli E, Ulukus EC, Zekioglu O.</strong> (2012).
Reproducibility of endometrial intraepithelial neoplasia diagnosis is
good, but influenced by the diagnostic style of pathologists. <em>Modern
Pathology</em>, 25(6), 877-884. doi: 10.1038/modpathol.2011.220. PMID:
22301705.</li>
</ol>
<hr>
<p><em>For additional support, please refer to the ClinicoPath
documentation or contact the development team.</em></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://www.serdarbalci.com/" class="external-link">Serdar Balci</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
